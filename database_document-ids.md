<div>

<div>

<div>

<div>

-   Home
-   Database
-   Document IDs

<div>

On this page

</div>

<div>

<div>

# Document IDs

</div>

**Example:** Relational Data Modeling

Every document in convex has a globally unique *document ID* that is
automatically generated by the system.

<div>

<div>

    const userId = await db.insert("users", { name: "Michael Jordan" });

<div>

![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)

</div>

</div>

</div>

You can access the ID of a document in the `_id` field:

<div>

<div>

    const userId = user._id;

<div>

![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)

</div>

</div>

</div>

You can use this ID to always issue a very efficient *point query*
within your functions using the `get` method:

<div>

<div>

    const retrievedUser = await db.get(documentId);

<div>

![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)

</div>

</div>

</div>

Also, this same ID can be used to update that document in place:

<div>

<div>

    await db.patch(documentId, { name: "Steph Curry" });

<div>

![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)

</div>

</div>

</div>

Convex generates an `Id` TypeScript type based on your schema that is
parameterized over your table names:

<div>

<div>

    import { Id } from "./_generated/dataModel";

    const userId: Id<"users"> = user._id;

<div>

![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)

</div>

</div>

</div>

The `Id` class generated in `convex/_generated/dataModel` is an alias to
the `GenericId` class in the `convex/values` entrypoint of the Convex
npm package.

<div>

<div>

![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)caution

</div>

<div>

`Id` is a class. To check if two `Id`s refer to the same document, use
`myId.equals(otherId)`.

Importantly, `===` won\'t work because two different instances of this
class can refer to the same document.

</div>

</div>

## References and relationships​

In Convex, you can reference a document simply by embedding its `Id` in
another document:

<div>

<div>

    await db.insert("books", {
      title,
      ownerId: user._id,
    });

<div>

![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)

</div>

</div>

</div>

You can follow references with `db.get`:

<div>

<div>

    const user = await db.get(book.ownerId);

<div>

![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)

</div>

</div>

</div>

And query for documents with a reference:

<div>

<div>

    const myBooks = await db
      .query("books")
      .filter(q => q.eq(q.field("ownerId"), user._id))
      .collect();

<div>

![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)

</div>

</div>

</div>

Using `Id`s as references can allow you to build a complex data model.

## Trading off deeply nested documents vs. relationships​

While it\'s useful that Convex supports nested objects and arrays,
should keep documents relatively small in size. In practice, we
recommend limiting lists to no more than 5-10 elements and avoiding
deeply nested documents.

Instead, leverage separate tables, documents, and references to
structure your data. This will lead to better maintainability and
performance as your project grows.

## Serializing IDs​

To turn an `Id` into a string, use the `.toString` method:

<div>

<div>

    const idString = user._id.toString();

<div>

![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)

</div>

</div>

</div>

This can be inserted into the URL or stored outside of Convex.

You can recreate the `Id` class by passing the ID string into its
constructor after the table name:

<div>

<div>

    import { Id } from "./_generated/dataModel";

    const userId = new Id("users", idString);

<div>

![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)![](data:image/svg+xml;base64,PHN2Zz48cGF0aD48L3BhdGg+PC9zdmc+)

</div>

</div>

</div>

</div>

</div>

</div>

</div>

</div>
